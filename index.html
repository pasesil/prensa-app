<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Gestión de Prensa</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1f2937">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Flatpickr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <!-- Lucide Icons -->
  <script src="https://cdn.jsdelivr.net/npm/lucide-react@0.378.0/dist/lucide.min.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-900 text-gray-200 font-inter">

  <div id="auth-container" class="text-center mb-4">
    <button id="sign-in-btn" class="bg-blue-600 px-4 py-2 rounded">Ingresar con Google</button>
    <button id="sign-out-btn" class="bg-red-600 px-4 py-2 rounded hidden">Cerrar sesión</button>
  </div>

  <div id="app-container" class="container mx-auto p-4 md:p-8 hidden">
    <!-- Cabecera -->
    <header class="mb-6 text-center">
      <h1 class="text-4xl font-bold">Gestión de Prensa</h1>
      <p class="text-lg text-gray-400 mt-2">Control centralizado de apariciones en medios</p>
    </header>
    
    <!-- Navegación de pestañas -->
    <div class="mb-6 border-b border-gray-700">
      <nav class="-mb-px flex space-x-6">
        <button class="tab-btn active" data-tab="ingreso"><i data-lucide="file-plus-2" class="mr-2"></i> Añadir Registro</button>
        <button class="tab-btn" data-tab="estadisticas"><i data-lucide="bar-chart-3" class="mr-2"></i> Estadísticas</button>
        <button class="tab-btn" data-tab="historico"><i data-lucide="history" class="mr-2"></i> Histórico</button>
      </nav>
    </div>

    <!-- Pestaña Ingreso -->
    <div id="ingreso-tab" class="tab-content">
      <div class="bg-gray-800 p-6 rounded-2xl shadow-lg max-w-2xl mx-auto">
        <form id="registro-form" class="space-y-5">
          <div><label for="fecha">Fecha</label><input type="text" id="fecha" name="fecha" required></div>
          <div><label for="titular">Titular</label><textarea id="titular" name="titular" rows="3" required></textarea></div>
          <div><label for="unidad">Unidad PDI</label><input type="text" id="unidad" name="unidad" required></div>
          <div><label for="medios-online">Medios Online</label><input type="text" id="medios-online" name="medios-online"></div>
          <div><label for="medios-escritos">Medios Escritos</label><input type="text" id="medios-escritos" name="medios-escritos"></div>
          <button type="submit" class="bg-blue-600 px-5 py-3 rounded w-full">Guardar Registro</button>
        </form>
      </div>
    </div>

    <!-- Pestaña Estadísticas -->
    <div id="estadisticas-tab" class="tab-content hidden">
      <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div><h3 class="mb-2">Apariciones por Unidad</h3><canvas id="unidades-chart"></canvas></div>
          <div><h3 class="mb-2">Top Medios</h3><canvas id="medios-chart"></canvas></div>
        </div>
        <button id="exportar-excel-btn" class="bg-gray-600 px-5 py-2 rounded mt-4" disabled>Exportar</button>
      </div>
    </div>

    <!-- Pestaña Histórico -->
    <div id="historico-tab" class="tab-content hidden">
      <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
        <div class="mb-4 flex flex-wrap gap-4">
          <input id="search-historico" type="text" placeholder="Buscar…">
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left text-gray-400">
            <thead><tr><th>Fecha</th><th>Titular</th><th>Unidad</th><th>Medios</th><th>Editar</th><th>Borrar</th></tr></thead>
            <tbody id="historico-table-body"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Editar -->
  <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden">
    <div class="bg-gray-800 p-6 rounded-lg max-w-md mx-auto mt-20">
      <h3 class="text-white mb-4">Editar Registro</h3>
      <form id="edit-form" class="space-y-4">
        <input type="text" id="edit-fecha" required>
        <textarea id="edit-titular" rows="2" required></textarea>
        <input type="text" id="edit-unidad" required>
        <input type="text" id="edit-medios-online">
        <input type="text" id="edit-medios-escritos">
        <button type="button" id="edit-save-btn" class="bg-yellow-500 px-4 py-2 rounded">Guardar cambios</button>
        <button type="button" id="edit-cancel-btn" class="bg-gray-600 px-4 py-2 rounded">Cancelar</button>
      </form>
    </div>
  </div>

  <!-- Modal Notificación -->
  <div id="notification-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden" tabindex="0" role="alertdialog">
    <div class="bg-gray-800 p-6 rounded-lg max-w-sm mx-auto mt-20 text-center">
      <div id="notification-icon"></div>
      <h3 id="notification-title" class="text-white mt-2"></h3>
      <p id="notification-message" class="text-gray-300 mt-2"></p>
      <button id="notification-close-btn" class="bg-blue-600 px-4 py-2 rounded mt-4">Cerrar</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
